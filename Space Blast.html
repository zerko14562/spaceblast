<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Space Blast Mobile+Desktop</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<style>
html,body{
  margin:0;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#05071a;
  color:#eaf6ff;
  font-family:sans-serif;
  overflow:hidden;
}
canvas{
  background:#001026;
  border-radius:8px;
  display:block;
}
#ui{
  position:absolute;
  top:10px;
  left:10px;
  z-index:10;
}
#ui button{
  margin-left:10px;
  padding:16px 24px;
  font-size:20px;
  font-weight:bold;
  border-radius:8px;
  background:rgba(255,255,255,0.2);
  color:#eaf6ff;
  border:none;
  cursor:pointer;
}
#touchControls{
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:30px;
}
.touchBtn{
  width:100px;
  height:100px;
  background:rgba(255,255,255,0.25);
  border-radius:50%;
  text-align:center;
  line-height:100px;
  font-weight:bold;
  font-size:28px;
  user-select:none;
  cursor:pointer;
}
</style>
</head>
<body>
<div id="ui">
Score: <span id="score">0</span> | Lives: <span id="lives">3</span>
<button id="start">Start</button>
<button id="pause">Pause</button>
</div>
<div id="touchControls">
<div class="touchBtn" id="left">◀</div>
<div class="touchBtn" id="fire">●</div>
<div class="touchBtn" id="right">▶</div>
</div>
<canvas id="c" width="640" height="480"></canvas>
<script>
const cv=document.getElementById('c'),ctx=cv.getContext('2d');
let W=cv.width,H=cv.height,score=0,lives=3,wave=0,level=1,player=null,ents=[],running=false,paused=false,last=0;
const keys={},scoreEl=document.getElementById('score'),livesEl=document.getElementById('lives');

// TOUCH CONTROLS
const leftBtn=document.getElementById('left');
const rightBtn=document.getElementById('right');
const fireBtn=document.getElementById('fire');
[leftBtn,rightBtn,fireBtn].forEach(btn=>{
  btn.addEventListener('touchstart',()=>keys[btn.id==='left'?'ArrowLeft':btn.id==='right'?'ArrowRight':'Space']=true);
  btn.addEventListener('touchend',()=>keys[btn.id==='left'?'ArrowLeft':btn.id==='right'?'ArrowRight':'Space']=false);
  btn.addEventListener('mousedown',()=>keys[btn.id==='left'?'ArrowLeft':btn.id==='right'?'ArrowRight':'Space']=true);
  btn.addEventListener('mouseup',()=>keys[btn.id==='left'?'ArrowLeft':btn.id==='right'?'ArrowRight':'Space']=false);
});

// KEYBOARD
document.addEventListener('keydown',e=>{keys[e.key]=true;if(e.key===' '||e.key==='Space') e.preventDefault();});
document.addEventListener('keyup',e=>keys[e.key]=false);

// PLAYER
class Player{
constructor(){this.x=W/2;this.y=H-40;this.r=14;this.cool=0;this.alive=true;this.power=1;this.shield=0;}
update(dt){if(!this.alive)return;if(keys.ArrowLeft||keys.a)this.x-=260*dt;if(keys.ArrowRight||keys.d)this.x+=260*dt;this.x=Math.max(this.r,Math.min(W-this.r,this.x));this.cool-=dt;}
draw(){if(!this.alive)return;ctx.save();ctx.translate(this.x,this.y);ctx.fillStyle='#bfefff';ctx.beginPath();ctx.moveTo(0,-14);ctx.lineTo(10,14);ctx.lineTo(-10,14);ctx.closePath();ctx.fill();if(this.shield>0){ctx.strokeStyle='rgba(0,200,255,0.25)';ctx.lineWidth=3;ctx.beginPath();ctx.arc(0,0,this.r+6,0,2*Math.PI);ctx.stroke();}ctx.restore();}
shoot(){if(this.cool>0)return;this.cool=0.18;if(this.power>=3){spawnBullet(this.x,this.y-18,0,-520,'player');spawnBullet(this.x-12,this.y-12,-60,-440,'player');spawnBullet(this.x+12,this.y-12,60,-440,'player');}else if(this.power>=2){spawnBullet(this.x-6,this.y-12,-20,-520,'player');spawnBullet(this.x+6,this.y-12,20,-520,'player');}else spawnBullet(this.x,this.y-18,0,-560,'player');}
}

// ENEMY
class Enemy{
constructor(x,y,type=0){this.x=x;this.y=y;this.r=12;this.type=type;this.hp=type===2?8:(type===1?3:1);this.osc=Math.random()*Math.PI*2;this.dead=false;}
update(dt){this.osc+=dt*2;this.y+=(50+this.type*20)*dt;this.x+=Math.sin(this.osc)*(20+this.type*10)*dt;if(this.y>H+30)this.dead=true;}
draw(){ctx.save();ctx.translate(this.x,this.y);if(this.type===2){ctx.fillStyle='#ff8b8b';ctx.fillRect(-24,-18,48,36);}else if(this.type===1){ctx.fillStyle='#ffd07a';ctx.beginPath();ctx.arc(0,0,14,0,2*Math.PI);ctx.fill();}else{ctx.fillStyle='#9affff';ctx.beginPath();ctx.moveTo(0,-10);ctx.lineTo(8,8);ctx.lineTo(-8,8);ctx.closePath();ctx.fill();}ctx.restore();}
}

// BULLET
class Bullet{constructor(x,y,vx,vy,tag){this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.r=4;this.tag=tag;this.dead=false;}
update(dt){this.x+=this.vx*dt;this.y+=this.vy*dt;if(this.y<-40||this.y>H+40||this.x<-40||this.x>W+40)this.dead=true;}
draw(){ctx.fillStyle=this.tag==='player'?'#bfffdc':'#ff9b9b';ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,2*Math.PI);ctx.fill();}}

function spawnBullet(x,y,vx,vy,tag){ents.push(new Bullet(x,y,vx,vy,tag));}
function spawnEnemy(x,y,type){ents.push(new Enemy(x,y,type));}

function startGame(){if(!player)player=new Player();running=true;paused=false;score=0;lives=3;wave=0;level=1;ents=[];player.alive=true;player.x=W/2;player.y=H-40;player.shield=0;nextWave();updateUI();}
function pauseGame(){paused=!paused;}
function nextWave(){wave++;level=Math.floor(wave/5)+1;let rows=Math.min(4,1+Math.floor(wave/3)),cols=Math.min(8,3+wave);let sp=W/(cols+1);for(let r=0;r<rows;r++)for(let c=1;c<=cols;c++){let t=Math.random()<0.05?2:(Math.random()<0.18?1:0);spawnEnemy(c*sp+Math.random()*10-5,-40-r*30,t);}}
function updateUI(){scoreEl.textContent=score;livesEl.textContent=lives;}

function handleCollisions(){for(let i=ents.length-1;i>=0;i--){let A=ents[i];if(A instanceof Bullet&&A.tag==='player'){for(let j=ents.length-1;j>=0;j--){let B=ents[j];if(B instanceof Enemy&&!B.dead&&Math.hypot(A.x-B.x,A.y-B.y)<A.r+B.r){B.hp--;A.dead=true;if(B.hp<=0){B.dead=true;score+=(B.type+1)*10;}}}}if(A instanceof Enemy&&player.alive&&Math.hypot(A.x-player.x,A.y-player.y)<A.r+player.r){A.dead=true;if(player.shield>0){player.shield--;}else{player.alive=false;lives--;setTimeout(()=>{if(lives>0){player.alive=true;player.x=W/2;player.y=H-40;player.shield=1;}else running=false;},700);}}}ents=ents.filter(e=>!e.dead);if(!ents.some(e=>e instanceof Enemy)&&running)nextWave();}

function loop(t){let dt=(t-last)/1000;last=t;if(running&&!paused){ctx.clearRect(0,0,W,H);player.update(dt);player.draw();if(keys[' ']||keys.Space)player.shoot();ents.forEach(e=>{e.update(dt);e.draw();});handleCollisions();updateUI();}requestAnimationFrame(loop);}

document.getElementById('start').onclick=startGame;
document.getElementById('pause').onclick=pauseGame;
requestAnimationFrame(t=>{last=t;loop(t);});
</script>
</body>
</html>
